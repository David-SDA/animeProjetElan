{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block body %}
    {% if app.user %}
        <h1 class="homeTitle">Welcome {{ app.user.pseudo }} !</h1>
    {% else %}
        <h1 class="homeTitle">Welcome !</h1>
    {% endif %}
    <main class="homeContainer">
        <section>
            <h2 class="homeSecondaryTitle">BEST THIS SEASON</h2>
            <div class="homeMultipleAnimes">
                {% for media in dataBestAnimeThisSeason.data.Page.media %}
                    <figure class="homeOneAnime">
                        <a href="{{ path('show_anime', { 'id' : media.id }) }}">
                            <div class="homeOneAnimeImageInfo">
                                <img src="{{ media.coverImage.large }}" alt="Cover Image of {{ media.title.romaji }}" class="homeOneAnimeImage">
                                <div class="homeHoverContent">
                                    <p class="homeOneAnimeInfoTitle">{{ media.title.romaji }}</p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% if media.episodes %}
                                            {% if media.episodes < 2 %}
                                                {{ media.episodes }} episode
                                            {% else %}
                                                {{ media.episodes }} episodes
                                            {% endif %}
                                        {% else %}    
                                            ? episodes
                                        {% endif %}
                                        - 
                                        {% if media.format %}
                                            {{ media.format }}
                                        {% else %}
                                            ?
                                        {% endif %}
                                    </p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% set mainStudios = [] %}
                                        {% for studio in media.studios.edges %}
                                            {% if studio.isMain %}
                                                {% set mainStudios = mainStudios|merge([studio.node.name]) %}
                                            {% endif %}
                                        {% endfor %}
                                        {{ mainStudios|join(' - ') }}
                                    </p>
                                    <div class="homeOneAnimeInfoGenres">
                                        {% for genre in media.genres %}
                                            <p class="homeOneAnimeInfoOneGenre" style="--media-color: {{ media.coverImage.color }};">{{ genre }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </a>
                        <figcaption class="homeOneAnimeTitle"><a href="{{ path('show_anime', { 'id' : media.id }) }}">{{ media.title.romaji }}</a></figcaption>
                    </figure>
                {% endfor %}
            </div>
        </section>
        <section>
            <h2 class="homeSecondaryTitle">NEXT SEASON</h2>
            <div class="homeMultipleAnimes">
                {% for media in dataNextSeasonAnime.data.Page.media %}
                    <figure class="homeOneAnime">
                        <a href="{{ path('show_anime', { 'id' : media.id }) }}">
                            <div class="homeOneAnimeImageInfo">
                                <img src="{{ media.coverImage.large }}" alt="Cover Image of {{ media.title.romaji }}" class="homeOneAnimeImage">
                                <div class="homeHoverContent">
                                    <p class="homeOneAnimeInfoTitle">{{ media.title.romaji }}</p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% if media.episodes %}
                                            {% if media.episodes < 2 %}
                                                {{ media.episodes }} episode
                                            {% else %}
                                                {{ media.episodes }} episodes
                                            {% endif %}
                                        {% else %}    
                                            ? episodes
                                        {% endif %}
                                        - 
                                        {% if media.format %}
                                            {{ media.format }}
                                        {% else %}
                                            ?
                                        {% endif %}
                                    </p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% set mainStudios = [] %}
                                        {% for studio in media.studios.edges %}
                                            {% if studio.isMain %}
                                                {% set mainStudios = mainStudios|merge([studio.node.name]) %}
                                            {% endif %}
                                        {% endfor %}
                                        {{ mainStudios|join(' - ') }}
                                    </p>
                                    <div class="homeOneAnimeInfoGenres">
                                        {% for genre in media.genres %}
                                            <p class="homeOneAnimeInfoOneGenre" style="--media-color: {{ media.coverImage.color }};">{{ genre }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </a>
                        <figcaption class="homeOneAnimeTitle"><a href="{{ path('show_anime', { 'id' : media.id }) }}">{{ media.title.romaji }}</a></figcaption>
                    </figure>
                {% endfor %}
            </div>
        </section>
        <section>
            <h2 class="homeSecondaryTitle">POPULAR</h2>
            <div class="homeMultipleAnimes">
                {% for media in dataPopularAnime.data.Page.media %}
                    <figure class="homeOneAnime">
                        <a href="{{ path('show_anime', { 'id' : media.id }) }}">
                            <div class="homeOneAnimeImageInfo">
                                <img src="{{ media.coverImage.large }}" alt="Cover Image of {{ media.title.romaji }}" class="homeOneAnimeImage">
                                <div class="homeHoverContent">
                                    <p class="homeOneAnimeInfoTitle">{{ media.title.romaji }}</p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% if media.episodes %}
                                            {% if media.episodes < 2 %}
                                                {{ media.episodes }} episode
                                            {% else %}
                                                {{ media.episodes }} episodes
                                            {% endif %}
                                        {% else %}    
                                            ? episodes
                                        {% endif %}
                                        - 
                                        {% if media.format %}
                                            {{ media.format }}
                                        {% else %}
                                            ?
                                        {% endif %}
                                    </p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% set mainStudios = [] %}
                                        {% for studio in media.studios.edges %}
                                            {% if studio.isMain %}
                                                {% set mainStudios = mainStudios|merge([studio.node.name]) %}
                                            {% endif %}
                                        {% endfor %}
                                        {{ mainStudios|join(' - ') }}
                                    </p>
                                    <div class="homeOneAnimeInfoGenres">
                                        {% for genre in media.genres %}
                                            <p class="homeOneAnimeInfoOneGenre" style="--media-color: {{ media.coverImage.color }};">{{ genre }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </a>
                        <figcaption class="homeOneAnimeTitle"><a href="{{ path('show_anime', { 'id' : media.id }) }}">{{ media.title.romaji }}</a></figcaption>
                    </figure>
                {% endfor %}
            </div>
        </section>
        <section>
            <div class="animeRemainingRightContentPartTitleContainer">
                <h2 class="homeSecondaryTitle">TOP 10</h2>
                <a href="{{ path('top_anime') }}" class="animeRemainingRightContentPartMore">View more</a>
            </div>
            <div class="homeMultipleAnimes topTen">
                {% for media in dataTopTenAnime.data.Page.media %}
                    <figure class="homeOneAnime">
                        <a href="{{ path('show_anime', { 'id' : media.id }) }}">
                            <div class="homeOneAnimeImageInfo">
                                <div class="homeOneAnimeTopRanking">{{ loop.index }}</div>
                                <img src="{{ media.coverImage.large }}" alt="Cover Image of {{ media.title.romaji }}" class="homeOneAnimeImage">
                                <div class="homeHoverContent">
                                    <p class="homeOneAnimeInfoTitle">{{ media.title.romaji }}</p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% if media.episodes %}
                                            {% if media.episodes < 2 %}
                                                {{ media.episodes }} episode
                                            {% else %}
                                                {{ media.episodes }} episodes
                                            {% endif %}
                                        {% else %}    
                                            ? episodes
                                        {% endif %}
                                        - 
                                        {% if media.format %}
                                            {{ media.format }}
                                        {% else %}
                                            ?
                                        {% endif %}
                                    </p>
                                    <p class="homeOneAnimeInfoSmallerInfos">
                                        {% set mainStudios = [] %}
                                        {% for studio in media.studios.edges %}
                                            {% if studio.isMain %}
                                                {% set mainStudios = mainStudios|merge([studio.node.name]) %}
                                            {% endif %}
                                        {% endfor %}
                                        {{ mainStudios|join(' - ') }}
                                    </p>
                                    <div class="homeOneAnimeInfoGenres">
                                        {% for genre in media.genres %}
                                            <p class="homeOneAnimeInfoOneGenre" style="--media-color: {{ media.coverImage.color }};">{{ genre }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </a>
                        <figcaption class="homeOneAnimeTitle"><a href="{{ path('show_anime', { 'id' : media.id }) }}">{{ media.title.romaji }}</a></figcaption>
                    </figure>
                {% endfor %}
            </div>
        </section>
    </main>
{% endblock %}